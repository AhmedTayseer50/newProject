<!-- src/app/admin/diploma-editor/diploma-editor.component.html -->

<div class="container py-4" dir="rtl">
  <a routerLink="/admin/dashboard" class="btn btn-link ps-0 mb-3">&larr; ุฑุฌูุน ูููุญุฉ ุงูุชุญูู</a>
  <h3 class="mb-3">{{ diplomaId ? 'โ๏ธ ุชุนุฏูู ุฏุจูููุฉ' : 'โ ุฅุถุงูุฉ ุฏุจูููุฉ ุฌุฏูุฏุฉ' }}</h3>

  <div *ngIf="error" class="alert alert-danger">{{ error }}</div>
  <div *ngIf="loading" class="alert alert-info">ุฌุงุฑู ุงูุชุญูููโฆ</div>

  <form *ngIf="!loading" (ngSubmit)="save()">

    <!-- ===== Basics ===== -->
    <h5 class="mb-2">ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ</h5>
    <div class="row g-3">
      <div class="col-md-6">
        <label class="form-label">ุงูุนููุงู</label>
        <input class="form-control" [(ngModel)]="data.title" name="title" required />
      </div>

      <div class="col-md-6">
        <label class="form-label">ุงูุชุตููู</label>
        <input class="form-control" [(ngModel)]="data.categoryId" name="categoryId" />
      </div>

      <div class="col-12">
        <label class="form-label">ุงููุตู</label>
        <textarea class="form-control" rows="3" [(ngModel)]="data.description" name="description"></textarea>
      </div>

      <div class="col-md-4">
        <label class="form-label">ุงูุณุนุฑ (ุงุฎุชูุงุฑู)</label>
        <input type="number" class="form-control" [(ngModel)]="data.price" name="price" />
      </div>

      <div class="col-md-8">
        <label class="form-label">ุงูุตูุฑุฉ (Thumbnail URL)</label>
        <input class="form-control" [(ngModel)]="data.thumbnail" name="thumbnail" />
      </div>

      <div class="col-12">
        <div class="form-check">
          <input class="form-check-input" type="checkbox" [(ngModel)]="data.published" name="published" id="published" />
          <label class="form-check-label" for="published">ููุดูุฑ</label>
        </div>
      </div>
    </div>

    <hr class="my-4" />

    <!-- ===== Hero fields ===== -->
    <h5 class="mb-2">Hero (ุฃุนูู ุตูุญุฉ ุงูุฏุจูููุฉ)</h5>
    <div class="row g-3">
      <div class="col-md-6">
        <label class="form-label">Eyebrow</label>
        <input class="form-control" [(ngModel)]="data.heroEyebrow" name="heroEyebrow" />
      </div>

      <div class="col-md-6">
        <label class="form-label">Tagline</label>
        <input class="form-control" [(ngModel)]="data.heroTagline" name="heroTagline" />
      </div>

      <div class="col-md-6">
        <label class="form-label">ูุฏุฉ ุงูุจุฑูุงูุฌ</label>
        <input class="form-control" [(ngModel)]="data.programDuration" name="programDuration" />
      </div>

      <div class="col-md-6">
        <label class="form-label">ุงููุฆุฉ ุงููุณุชูุฏูุฉ</label>
        <input class="form-control" [(ngModel)]="data.targetAudience" name="targetAudience" />
      </div>

      <div class="col-md-6">
        <label class="form-label">Level (ุงุฎุชูุงุฑู)</label>
        <input class="form-control" [(ngModel)]="data.meta.level" name="metaLevel" />
      </div>
    </div>

    <hr class="my-4" />

    <!-- ===== Info cards ===== -->
    <h5 class="mb-2">ุจุทุงูุงุช ุงููุนูููุงุช (ูุจู ุงูุดุฑุงุก)</h5>
    <div class="row g-3">
      <div class="col-md-6">
        <label class="form-label">ุงููุฏู ูู ุงูุฏุฑุงุณุฉ - ุนููุงู</label>
        <input class="form-control" [(ngModel)]="data.goalTitle" name="goalTitle" />
      </div>
      <div class="col-md-6">
        <label class="form-label">ุงููุฏู ูู ุงูุฏุฑุงุณุฉ - ูุตู</label>
        <input class="form-control" [(ngModel)]="data.goalDescription" name="goalDescription" />
      </div>

      <div class="col-md-6">
        <label class="form-label">ุงููุฏุฉ ุงููุชููุนุฉ - ุนููุงู</label>
        <input class="form-control" [(ngModel)]="data.expectedStudyTimeTitle" name="expectedStudyTimeTitle" />
      </div>
      <div class="col-md-6">
        <label class="form-label">ุงููุฏุฉ ุงููุชููุนุฉ - ูุตู</label>
        <input class="form-control" [(ngModel)]="data.expectedStudyTimeDescription" name="expectedStudyTimeDescription" />
      </div>

      <div class="col-md-6">
        <label class="form-label">ุงูุฎุจุฑุงุช ุงูุณุงุจูุฉ - ุนููุงู</label>
        <input class="form-control" [(ngModel)]="data.prerequisitesTitle" name="prerequisitesTitle" />
      </div>
      <div class="col-md-6">
        <label class="form-label">ุงูุฎุจุฑุงุช ุงูุณุงุจูุฉ - ูุตู</label>
        <input class="form-control" [(ngModel)]="data.prerequisitesDescription" name="prerequisitesDescription" />
      </div>
    </div>

    <hr class="my-4" />

    <!-- ===== Video ===== -->
    <h5 class="mb-2">ููุฏูู ุชุนุฑููู</h5>
    <div class="row g-3">
      <div class="col-12">
        <label class="form-label">Intro Video URL (YouTube embed)</label>
        <input class="form-control" [(ngModel)]="data.introVideoUrl" name="introVideoUrl" />
        <div class="form-text">ูุซุงู: https://www.youtube.com/embed/XXXXXXXX</div>
      </div>
    </div>

    <hr class="my-4" />

    <!-- ===== Specs ===== -->
    <h5 class="mb-2">ุงูููุงุตูุงุช ุงููููุฉ / ูุนูููุงุช ุฅุถุงููุฉ</h5>
    <div class="mb-2 d-flex gap-2">
      <button type="button" class="btn btn-outline-primary btn-sm" (click)="addSpec()">+ ุฅุถุงูุฉ ููุทุฉ</button>
      <span class="text-muted small align-self-center">ุงูุชุจ ููุงุท ูุตูุฑุฉ</span>
    </div>

    <div class="row g-2" *ngFor="let s of data.specs; let i = index">
      <div class="col-11">
        <input class="form-control" [(ngModel)]="data.specs[i]" name="spec{{i}}" placeholder="ูุซุงู: ูุฏุฉ ูู ูุญุงุถุฑุฉ 20-30 ุฏูููุฉ" />
      </div>
      <div class="col-1 d-grid">
        <button type="button" class="btn btn-outline-danger" (click)="removeSpec(i)">ร</button>
      </div>
    </div>

    <hr class="my-4" />

    <!-- ===== Testimonials ===== -->
    <h5 class="mb-2">ุขุฑุงุก ุงูุนููุงุก (ุนูู ุงูุฃูู 3)</h5>

    <div class="card mb-3" *ngFor="let t of data.testimonials; let i = index">
      <div class="card-body">
        <div class="row g-3">
          <div class="col-md-4">
            <label class="form-label">ุงูุงุณู</label>
            <input class="form-control" [(ngModel)]="data.testimonials[i].name" name="t_name{{i}}" />
          </div>

          <div class="col-md-4">
            <label class="form-label">ุงูุตูุฉ (ุงุฎุชูุงุฑู)</label>
            <input class="form-control" [(ngModel)]="data.testimonials[i].tag" name="t_tag{{i}}" />
          </div>

          <div class="col-md-4">
            <label class="form-label">ุงูุชูููู (1-5)</label>
            <input type="number" min="1" max="5" class="form-control" [(ngModel)]="data.testimonials[i].rating" name="t_rating{{i}}" />
          </div>

          <div class="col-12">
            <label class="form-label">ุงููุต</label>
            <textarea class="form-control" rows="2" [(ngModel)]="data.testimonials[i].text" name="t_text{{i}}"></textarea>
          </div>
        </div>
      </div>
    </div>

    <hr class="my-4" />

    <!-- ===== Pricing (3 plans) ===== -->
    <h5 class="mb-2">ุฎุทุท ุงูุฃุณุนุงุฑ (3 ุฎุทุท)</h5>

    <div class="card mb-3" *ngFor="let p of data.pricingPlans; let pi = index">
      <div class="card-body">
        <div class="row g-3">
          <div class="col-md-4">
            <label class="form-label">ุงุณู ุงูุฎุทุฉ</label>
            <input class="form-control" [(ngModel)]="data.pricingPlans[pi].name" name="p_name{{pi}}" />
          </div>

          <div class="col-md-4">
            <label class="form-label">Badge</label>
            <input class="form-control" [(ngModel)]="data.pricingPlans[pi].badge" name="p_badge{{pi}}" />
          </div>

          <div class="col-md-4">
            <label class="form-label">ุงูุณุนุฑ (ูุต)</label>
            <input class="form-control" [(ngModel)]="data.pricingPlans[pi].priceText" name="p_price{{pi}}" placeholder="ูุซุงู: 399 ุฑ.ุณ" />
          </div>

          <div class="col-12">
            <label class="form-label">ููุงุญุธุฉ</label>
            <input class="form-control" [(ngModel)]="data.pricingPlans[pi].note" name="p_note{{pi}}" />
          </div>

          <div class="col-12">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" [(ngModel)]="data.pricingPlans[pi].highlighted" name="p_high{{pi}}" id="high{{pi}}" />
              <label class="form-check-label" [for]="'high'+pi">ุฎุทุฉ ูููุฒุฉ (Highlight)</label>
            </div>
          </div>

          <div class="col-12">
            <div class="d-flex gap-2 mb-2">
              <button type="button" class="btn btn-outline-primary btn-sm" (click)="addFeature(pi)">+ ุฅุถุงูุฉ ููุฒุฉ</button>
              <span class="text-muted small align-self-center">ูููุฒุงุช ุงูุฎุทุฉ</span>
            </div>

            <div class="row g-2" *ngFor="let f of data.pricingPlans[pi].features; let fi = index">
              <div class="col-11">
                <input class="form-control" [(ngModel)]="data.pricingPlans[pi].features[fi]" name="p_f{{pi}}_{{fi}}" />
              </div>
              <div class="col-1 d-grid">
                <button type="button" class="btn btn-outline-danger" (click)="removeFeature(pi, fi)">ร</button>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>

    <hr class="my-4" />

    <!-- ===== Community Perks ===== -->
    <h5 class="mb-2">ูููุฒุงุช ุงููุชุงุจุนุฉ (WhatsApp / Facebook + ุฎุตููุงุช ุฌูุณุงุช)</h5>

    <div class="mb-2 d-flex gap-2">
      <button type="button" class="btn btn-outline-primary btn-sm" (click)="addPerk()">+ ุฅุถุงูุฉ ููุฒุฉ</button>
    </div>

    <div class="row g-2" *ngFor="let p of data.communityPerks; let i = index">
      <div class="col-11">
        <input class="form-control" [(ngModel)]="data.communityPerks[i]" name="perk{{i}}" placeholder="ูุซุงู: ุฌุฑูุจ ูุงุชุณุงุจ ููุฃุณุฆูุฉ ูุงููุชุงุจุนุฉ ุจุนุฏ ุงูุดุฑุงุก" />
      </div>
      <div class="col-1 d-grid">
        <button type="button" class="btn btn-outline-danger" (click)="removePerk(i)">ร</button>
      </div>
    </div>

    <hr class="my-4" />

    <!-- ===== Offer popup ===== -->
    <h5 class="mb-2">ุนุฑุถ ุขุฎุฑ ุงูุตูุญุฉ (Popup ุฎุตู)</h5>
    <div class="row g-3">
      <div class="col-md-3">
        <label class="form-label">ูุณุจุฉ ุงูุฎุตู</label>
        <input type="number" class="form-control" [(ngModel)]="data.offer.percent" name="offerPercent" />
      </div>

      <div class="col-md-9">
        <label class="form-label">ุนููุงู ุงูุนุฑุถ</label>
        <input class="form-control" [(ngModel)]="data.offer.heading" name="offerHeading" />
      </div>

      <div class="col-12">
        <label class="form-label">ูุต ุงูุนุฑุถ</label>
        <textarea class="form-control" rows="2" [(ngModel)]="data.offer.text" name="offerText"></textarea>
      </div>

      <div class="col-12">
        <label class="form-label">ูุต ุฒุฑ CTA</label>
        <input class="form-control" [(ngModel)]="data.offer.ctaText" name="offerCtaText" />
      </div>
    </div>

    <hr class="my-4" />

    <!-- ===== Bottom CTA ===== -->
    <h5 class="mb-2">CTA ุขุฎุฑ ุงูุตูุญุฉ</h5>
    <div class="row g-3">
      <div class="col-12">
        <label class="form-label">ุงููุต</label>
        <input class="form-control" [(ngModel)]="data.bottomCta.text" name="bottomCtaText" />
      </div>
      <div class="col-12">
        <label class="form-label">ูุต ุงูุฒุฑ</label>
        <input class="form-control" [(ngModel)]="data.bottomCta.buttonText" name="bottomCtaBtn" />
      </div>
    </div>

    <hr class="my-4" />

    <!-- ===== Courses in diploma ===== -->
    <h5 class="mb-2">๐ ููุฑุณุงุช ุงูุฏุจูููุฉ</h5>
    <div class="text-muted small mb-3">ุงุฎุชุฑ ุงูููุฑุณุงุช ุงููู ูุชุชุฌูุน ุฏุงุฎู ุงูุฏุจูููุฉ:</div>

    <div class="list-group">
      <label class="list-group-item d-flex align-items-center gap-2" *ngFor="let c of courses">
        <input
          type="checkbox"
          class="form-check-input"
          [checked]="isSelected(c.id)"
          (change)="toggleCourse(c.id, $any($event.target).checked)"
        />
        <span>{{ c.title || c.id }}</span>
        <span class="ms-auto small text-muted">{{ c.id }}</span>
      </label>
    </div>

    <div class="mt-4 d-flex gap-2">
      <button class="btn btn-primary" type="submit">ุญูุธ</button>
      <a class="btn btn-outline-secondary" routerLink="/admin/dashboard">ุฅูุบุงุก</a>
    </div>
  </form>
</div>
