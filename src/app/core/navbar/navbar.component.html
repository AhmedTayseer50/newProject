<header [attr.dir]="currentLang === 'ar' ? 'rtl' : 'ltr'" class="site-header">

  <div class="page-container nav">
    <!-- ุงูุดุนุงุฑ + ุงุณู ุงูููุตูุฉ -->
    <div class="nav-left">
      <div class="logo-circle">
        <a routerLink="/" fragment="hero">
          <img src="assets/images/life puls 2.png" i18n-alt alt="ูุจุถุฉ ุญูุงุฉ" />
        </a>
      </div>

      <div class="logo-text-wrapper">
        <span class="logo-text-main" i18n>ูุจุถุฉ ุญูุงุฉ</span>
        <span class="logo-text-sub" i18n>ููุตุฉ ููุตุญุฉ ุงูููุณูุฉ ูุงูุชุนููู</span>
      </div>
    </div>

    <!-- ุฒุฑ ุงููุงุฆูุฉ ููููุจุงูู -->
    <button
      class="nav-menu-toggle"
      type="button"
      i18n-aria-label
      aria-label="ุงููุงุฆูุฉ"
      [attr.aria-expanded]="isMenuOpen"
      (click)="isMenuOpen = !isMenuOpen"
    >
      โฐ
    </button>

    <!-- ุฑูุงุจุท ุงูุฏูุณูุชูุจ -->
    <nav class="nav-links">
      <a routerLink="/" fragment="hero" routerLinkActive="active" i18n>ุงูุฑุฆูุณูุฉ</a>
      <a routerLink="/courses" routerLinkActive="active" i18n>ุงูููุฑุณุงุช</a>
      <a routerLink="/diplomas" routerLinkActive="active" i18n>ุงูุฏุจูููุงุช</a>
      <a
        routerLink="/consultations"
        routerLinkActive="active"
        class="constlut"
        i18n
      >
        ุงูุงุณุชุดุงุฑุงุช
      </a>
      <a routerLink="/about" routerLinkActive="active" i18n>ุนู ุงูุฏูุชูุฑุฉ</a>
      <a routerLink="/contact" routerLinkActive="active" i18n>ุชูุงุตู</a>
    </nav>

    <!-- ุฃุฒุฑุงุฑ ุงูุฏูุณูุชูุจ -->
    <div class="nav-actions">
      <!-- ุฒุฑ ุงูุซูู -->
      <button
        id="themeToggle"
        class="theme-toggle"
        type="button"
        (click)="toggleTheme()"
        i18n-aria-label
        aria-label="ุชุบููุฑ ุงููุถุน"
        [attr.title]="isDarkTheme ? 'ุงููุถุน ุงููุงุชุญ' : 'ุงููุถุน ุงูุฏุงูู'"
      >
        {{ isDarkTheme ? "โ๏ธ" : "๐" }}
      </button>

      <!-- ุฒุฑ ุงููุบุฉ -->
      <button
        class="btn btn-ghost"
        type="button"
        (click)="switchLanguage()"
        i18n-aria-label
        [attr.aria-label]="
          currentLang === 'ar' ? 'Switch to English' : 'ุงูุชุจุฏูู ุฅูู ุงูุนุฑุจูุฉ'
        "
      >
        {{ currentLang === "ar" ? "EN" : "AR" }}
      </button>

      <!-- ุบูุฑ ูุณุฌูู -->
      <ng-container *ngIf="!(auth.isLoggedIn$ | async); else loggedIn">
        <button class="btn btn-ghost" type="button" routerLink="/login" i18n>
          ุฏุฎูู
        </button>
        <button class="btn btn-primary" type="button" routerLink="/register" i18n>
          ุญุณุงุจ ุฌุฏูุฏ
        </button>
      </ng-container>

      <!-- ูุณุฌูู -->
      <ng-template #loggedIn>
        <div class="nav-user-info">
          <span *ngIf="auth.user$ | async as u" class="nav-user-label" i18n>
            ูุฑุญุจูุงุ {{ u.email }}
          </span>
          <span *ngIf="isDisabled" class="badge-disabled" i18n>ุญุณุงุจ ูุนุทูู</span>

          <button class="btn btn-ghost" type="button" routerLink="/my-courses" i18n>
            ููุฑุณุงุชู
          </button>
        </div>

        <button
          *ngIf="(isAdmin || isStaff) && !isDisabled"
          class="btn btn-ghost"
          type="button"
          [routerLink]="isAdmin ? '/admin/cases' : '/staff/cases'"
        >
          <span i18n>Cases</span>
        </button>

        <button
          *ngIf="isAdmin && !isDisabled"
          class="btn btn-ghost btn-admin"
          type="button"
          routerLink="/admin/dashboard"
        >
          <span i18n>Dashboard</span>
        </button>

        <button class="btn btn-ghost" type="button" routerLink="/profile" i18n>
          ุงูููู ุงูุดุฎุตู
        </button>

        <button
          class="btn btn-ghost btn-logout"
          type="button"
          (click)="auth.logout()"
          i18n
        >
          ุฎุฑูุฌ
        </button>
      </ng-template>
    </div>
  </div>

  <!-- โ Mobile Panel -->
  <div class="mobile-panel" [class.open]="isMenuOpen">
    <div class="page-container mobile-inner">
      <nav class="mobile-links" (click)="isMenuOpen = false">
        <a routerLink="/" fragment="hero" routerLinkActive="active" i18n>ุงูุฑุฆูุณูุฉ</a>
        <a routerLink="/courses" routerLinkActive="active" i18n>ุงูููุฑุณุงุช</a>
        <a routerLink="/diplomas" routerLinkActive="active" i18n>ุงูุฏุจูููุงุช</a>
        <a routerLink="/consultations" routerLinkActive="active" i18n>ุงูุงุณุชุดุงุฑุงุช</a>
        <a routerLink="/about" routerLinkActive="active" i18n>ุนู ุงูุฏูุชูุฑุฉ</a>
        <a routerLink="/contact" routerLinkActive="active" i18n>ุชูุงุตู</a>
      </nav>

      <div class="mobile-actions" (click)="isMenuOpen = false">
        <!-- ุฒุฑ ุงููุบุฉ (Mobile) -->
        <button
          class="btn btn-ghost w-100"
          type="button"
          (click)="switchLanguage()"
          i18n-aria-label
          [attr.aria-label]="
            currentLang === 'ar' ? 'Switch to English' : 'ุงูุชุจุฏูู ุฅูู ุงูุนุฑุจูุฉ'
          "
        >
          {{ currentLang === "ar" ? "EN" : "AR" }}
        </button>

        <ng-container *ngIf="!(auth.isLoggedIn$ | async); else loggedInMobile">
          <button class="btn btn-ghost w-100" type="button" routerLink="/login" i18n>
            ุฏุฎูู
          </button>
          <button class="btn btn-primary w-100" type="button" routerLink="/register" i18n>
            ุญุณุงุจ ุฌุฏูุฏ
          </button>
        </ng-container>

        <ng-template #loggedInMobile>
          <button class="btn btn-ghost w-100" type="button" routerLink="/my-courses" i18n>
            ููุฑุณุงุชู
          </button>

          <button
            *ngIf="(isAdmin || isStaff) && !isDisabled"
            class="btn btn-ghost w-100"
            type="button"
            [routerLink]="isAdmin ? '/admin/cases' : '/staff/cases'"
          >
            <span i18n>Cases</span>
          </button>

          <button
            *ngIf="isAdmin && !isDisabled"
            class="btn btn-ghost btn-admin w-100"
            type="button"
            routerLink="/admin/dashboard"
          >
            <span i18n>Dashboard</span>
          </button>

          <button class="btn btn-ghost w-100" type="button" routerLink="/profile" i18n>
            ุงูููู ุงูุดุฎุตู
          </button>

          <button
            class="btn btn-ghost btn-logout w-100"
            type="button"
            (click)="auth.logout()"
            i18n
          >
            ุฎุฑูุฌ
          </button>
        </ng-template>
      </div>
    </div>
  </div>
</header>
